setwd("C:/Users/pc/Desktop/politecnico/b- inferenza statistica/progetto")
library(car)
library(faraway)
library(leaps)
library(MASS)
library(GGally)
library(rgl)
library(dplyr)
library(data.table)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(AID)
library(onewaytests)
#Carico il dataset
Foot=read.csv("Football teams.csv", header=TRUE);
head(Foot)
View(Foot)
View(Foot)
#summarydeidati
summary(Foot)
#controllo correlazione covariate
ggpairs(data = Foot[c('Goals','Shots.pg','yellow_cards','red_cards','Possession.','Pass.','AerialsWon','Rating')], title ="Relationships between predictors & response",lower = list(continuous=wrap("points", alpha = 0.5, size=0.1)))
#creo il modello dove y è Goals con TUTTE le covariate disponibili(Tranne le categoriche)
g=lm(Goals~.-Tournament-Team, Foot)
summary(g)
#controllo correlazione tra covariate
X=Foot[c(4:10)]
cor(X)
corrplot( cor(X), method='number')
#controllo omoschedasticità residui
plot(g,which=1)
#shapiro benisssimo
shapiro.test(g$residuals)
#qqnorm bello
qqnorm( g$residuals, ylab = "Raw Residuals", pch = 16 )
qqline( g$residuals )
AIC(g)
step(g,direction="backward", trace=T)
g_step=lm(Goals~.-Team-Tournament-Possession.-red_cards,Foot)
summary(g_step)
shapiro.test(g_step$residuals)
plot(g_step,which=1)
AIC(g_step)
my_colors = brewer.pal( 5, 'Set1')
boxplot(boxplot( Foot$Goals ~ Foot$Tournament , xlab = 'Tournament', ylab = 'Goals',col = my_colors ))
abline(h=mean(Foot$Goals),col='red')
library(car)
library(faraway)
library(leaps)
library(MASS)
library(GGally)
library(rgl)
library(dplyr)
library(data.table)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(AID)
library(onewaytests)
library(car)
library(faraway)
library(leaps)
library(MASS)
library(GGally)
library(rgl)
library(dplyr)
library(data.table)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(AID)
library(onewaytests)
library(car)
library(faraway)
library(leaps)
library(MASS)
library(GGally)
library(rgl)
library(dplyr)
library(data.table)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(AID)
library(onewaytests)
setwd("C:/Users/pc/Desktop/politecnico/TRIENNALE/b- inferenza statistica/progetto")
library(car)
library(faraway)
library(leaps)
library(MASS)
library(GGally)
library(rgl)
library(dplyr)
library(data.table)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(AID)
library(onewaytests)
#Carico il dataset
Foot=read.csv("Football teams.csv", header=TRUE);
head(Foot)
View(Foot)
View(Foot)
#summarydeidati
summary(Foot)
#controllo correlazione covariate
ggpairs(data = Foot[c('Goals','Shots.pg','yellow_cards','red_cards','Possession.','Pass.','AerialsWon','Rating')], title ="Relationships between predictors & response",lower = list(continuous=wrap("points", alpha = 0.5, size=0.1)))
#creo il modello dove y è Goals con TUTTE le covariate disponibili(Tranne le categoriche)
g=lm(Goals~.-Tournament-Team, Foot)
summary(g)
#controllo correlazione tra covariate
X=Foot[c(4:10)]
cor(X)
corrplot( cor(X), method='number')
#controllo omoschedasticità residui
plot(g,which=1)
#shapiro benisssimo
shapiro.test(g$residuals)
#qqnorm bello
qqnorm( g$residuals, ylab = "Raw Residuals", pch = 16 )
